1. Find all active partnerships involving a specific company user.

SELECT 
    p.id AS partnership_id,
    p.name AS partnership_name,
    c.id AS company_id,
    c.name AS company_name
FROM User u
JOIN User_Partnership_Responsibility upr ON u.id = upr.user_id
JOIN Partnership p ON upr.partnership_id = p.id
JOIN Company c ON p.lead_company_id = c.id
WHERE u.id = ? AND CURRENT_DATE BETWEEN p.start_date AND p.end_date;




2. List all company users with their roles.

SELECT 
    u.id AS user_id,
    u.username,
    c.name AS company_name,
    u.role AS user_role
FROM users u
JOIN companies c ON u.company_id = c.id
ORDER BY c.name, u.name;





3. List all users associated with a specific partnership, including their roles.

SELECT 
    u.id AS user_id,
    u.username,
    p.id AS partnership_id,
    upr.role AS user_role
FROM users u
JOIN user_partnership_roles upr ON upr.user_id = u.id
JOIN partnerships p ON upr.partnership_id = p.id
WHERE p.id = ?;





4. Get the total revenue generated by the specific partnership for a company.

SELECT 
    p.id AS partnership_id,
    c.name AS company_name,
    SUM(o.amount) AS total_revenue
FROM Company c
JOIN Partnership p ON c.id = p.lead_company_id
JOIN Solution s ON p.id = s.partnership_id
JOIN Solution_Lead sl ON s.id = sl.solution_id
JOIN Opportunity o ON sl.lead_id = o.id
WHERE p.id = ? AND c.id = ?
GROUP BY p.id, c.name;



